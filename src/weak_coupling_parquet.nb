(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     26571,        681]
NotebookOptionsPosition[     25170,        656]
NotebookOutlinePosition[     25568,        672]
CellTagsIndexPosition[     25525,        669]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ua", "[", "d", "]"}], "=", "u"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ua", "[", "m", "]"}], "=", 
   RowBox[{"-", "u"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ua", "[", "s", "]"}], "=", 
   RowBox[{"2", "u"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ua", "[", "t", "]"}], "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.953087213702486*^9, 3.9530872556874647`*^9}, {
  3.953177998953631*^9, 3.95317800211594*^9}, {3.9531782533141193`*^9, 
  3.953178261044722*^9}, {3.953188467947339*^9, 3.953188472090803*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4f0a758a-204e-49a8-aef7-01220fa0e91a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F1", "[", 
   RowBox[{
   "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "a_"}],
    "]"}], ":=", 
  RowBox[{"Ua", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]1", "[", 
   RowBox[{
   "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "a_"}],
    "]"}], ":=", 
  RowBox[{"Ua", "[", "a", "]"}]}]}], "Input",
 CellChangeTimes->{{3.953091292009956*^9, 3.953091331699095*^9}, {
  3.953176262448398*^9, 3.953176265021319*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"923f2336-213f-4574-bab6-6900ec1a9fd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "[", 
   RowBox[{"v_", ",", "k_"}], "]"}], ":=", 
  FractionBox["1", 
   RowBox[{"v", "-", 
    RowBox[{"disp", "[", "k", "]"}], "+", "mu"}]]}]], "Input",
 CellChangeTimes->{{3.953088672499811*^9, 3.953088703124935*^9}, {
  3.953176144317178*^9, 3.953176144975395*^9}, {3.9531762508736343`*^9, 
  3.953176253472492*^9}, {3.95317784191854*^9, 3.953177842337064*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"61b803e5-9398-4b21-9e6b-8645f8f41232"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]0", "[", 
   RowBox[{"v_", ",", "w_", ",", "k_", ",", "q_", ",", "d"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"v", ",", "k"}], "]"}], 
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"v", "+", "w"}], ",", 
     RowBox[{"k", "+", "q"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]0", "[", 
   RowBox[{"v_", ",", "w_", ",", "k_", ",", "q_", ",", "m"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"v", ",", "k"}], "]"}], 
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"v", "+", "w"}], ",", 
     RowBox[{"k", "+", "q"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]0", "[", 
   RowBox[{"v_", ",", "w_", ",", "k_", ",", "q_", ",", "s"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], 
   RowBox[{"G", "[", 
    RowBox[{"v", ",", "k"}], "]"}], 
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"w", "-", "v"}], ",", 
     RowBox[{"q", "-", "k"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]0", "[", 
   RowBox[{"v_", ",", "w_", ",", "k_", ",", "q_", ",", "t"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"G", "[", 
    RowBox[{"v", ",", "k"}], "]"}], 
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"w", "-", "v"}], ",", 
     RowBox[{"q", "-", "k"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9530887276849613`*^9, 3.953088789609686*^9}, {
   3.9531762571635113`*^9, 3.9531762607547483`*^9}, 3.953278390454316*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"8e544cdf-6057-49f2-bc40-93b45aa5f2f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dynamiclimit", "[", 
   RowBox[{"k1_", ",", "a_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Ua", "[", "a", "]"}], "2"], 
   RowBox[{"MatsubaraSum", "[", 
    RowBox[{
     RowBox[{"\[Chi]0", "[", 
      RowBox[{"v1", ",", "0", ",", "k1", ",", "0", ",", "a"}], "]"}], ",", 
     RowBox[{"v1", "\[Element]", "Fermionic"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.953627572839117*^9, 3.953627609004919*^9}, {
  3.953627667354888*^9, 3.953627691699566*^9}, {3.953627759879113*^9, 
  3.95362776248695*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"30b5dbc7-36f1-40a2-8821-0065563f1914"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalPhi]1", "[", 
   RowBox[{"w_", ",", "q_", ",", "d", ",", "k1_"}], "]"}], ":=", 
  RowBox[{"cnorm", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dynamiclimit", "[", 
         RowBox[{"k1", ",", "d"}], "]"}], ",", 
        RowBox[{
         RowBox[{"IsZero", "[", "w", "]"}], "&&", 
         RowBox[{"IsZero", "[", "q", "]"}]}]}], "}"}], "}"}], ",", 
     RowBox[{"MatsubaraSum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalGamma]1", "[", 
         RowBox[{
         "v", ",", "v1", ",", "w", ",", "k", ",", "k1", ",", "q", ",", "d"}], 
         "]"}], 
        RowBox[{"\[Chi]0", "[", 
         RowBox[{"v1", ",", "w", ",", "k1", ",", "q", ",", "d"}], "]"}], 
        RowBox[{"F1", "[", 
         RowBox[{
         "v1", ",", "vp", ",", "w", ",", "k1", ",", "kp", ",", "q", ",", 
          "d"}], "]"}]}], ",", 
       RowBox[{"v1", "\[Element]", "Fermionic"}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"w", "\[Element]", "Bosonic"}]}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]1", "[", 
   RowBox[{"w_", ",", "q_", ",", "m", ",", "k1_"}], "]"}], ":=", 
  RowBox[{"cnorm", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dynamiclimit", "[", 
         RowBox[{"k1", ",", "m"}], "]"}], ",", 
        RowBox[{
         RowBox[{"IsZero", "[", "w", "]"}], "&&", 
         RowBox[{"IsZero", "[", "q", "]"}]}]}], "}"}], "}"}], ",", 
     RowBox[{"MatsubaraSum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalGamma]1", "[", 
         RowBox[{
         "v", ",", "v1", ",", "w", ",", "k", ",", "k1", ",", "q", ",", "m"}], 
         "]"}], 
        RowBox[{"\[Chi]0", "[", 
         RowBox[{"v1", ",", "w", ",", "k1", ",", "q", ",", "m"}], "]"}], 
        RowBox[{"F1", "[", 
         RowBox[{
         "v1", ",", "vp", ",", "w", ",", "k1", ",", "kp", ",", "q", ",", 
          "m"}], "]"}]}], ",", 
       RowBox[{"v1", "\[Element]", "Fermionic"}], ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"w", "\[Element]", "Bosonic"}]}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]1", "[", 
   RowBox[{"w_", ",", "q_", ",", "s", ",", "k1_"}], "]"}], ":=", 
  RowBox[{"cnorm", " ", 
   RowBox[{"MatsubaraSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalGamma]1", "[", 
       RowBox[{
       "v", ",", "v1", ",", "w", ",", "k", ",", "k1", ",", "q", ",", "s"}], 
       "]"}], 
      RowBox[{"\[Chi]0", "[", 
       RowBox[{"v1", ",", "w", ",", "k1", ",", "q", ",", "s"}], "]"}], 
      RowBox[{"F1", "[", 
       RowBox[{
       "v1", ",", "vp", ",", "w", ",", "k1", ",", "kp", ",", "q", ",", "s"}], 
       "]"}]}], ",", 
     RowBox[{"v1", "\[Element]", "Fermionic"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"w", "\[Element]", "Bosonic"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]1", "[", 
   RowBox[{"w_", ",", "q_", ",", "t", ",", "k1_"}], "]"}], ":=", 
  RowBox[{"cnorm", " ", 
   RowBox[{"MatsubaraSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalGamma]1", "[", 
       RowBox[{
       "v", ",", "v1", ",", "w", ",", "k", ",", "k1", ",", "q", ",", "t"}], 
       "]"}], 
      RowBox[{"\[Chi]0", "[", 
       RowBox[{"v1", ",", "w", ",", "k1", ",", "q", ",", "t"}], "]"}], 
      RowBox[{"F1", "[", 
       RowBox[{
       "v1", ",", "vp", ",", "w", ",", "k1", ",", "kp", ",", "q", ",", "t"}], 
       "]"}]}], ",", 
     RowBox[{"v1", "\[Element]", "Fermionic"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"w", "\[Element]", "Bosonic"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9530913459669867`*^9, 3.953091504975956*^9}, {
  3.953091582306765*^9, 3.9530917060887547`*^9}, {3.953091738715399*^9, 
  3.9530918026215563`*^9}, {3.9530928671820183`*^9, 3.9530929118216133`*^9}, {
  3.9530932318971167`*^9, 3.9530932323684673`*^9}, {3.9536228876188583`*^9, 
  3.9536229075486*^9}, {3.953623663266553*^9, 3.953623703701007*^9}, {
  3.953623750032279*^9, 3.953623770589463*^9}, {3.9536273945340347`*^9, 
  3.953627440629878*^9}, {3.953627615727409*^9, 3.953627621473814*^9}, {
  3.953627786385181*^9, 3.953627797501725*^9}, {3.953628363425071*^9, 
  3.953628432037427*^9}, {3.953628657959969*^9, 3.95362866111734*^9}, {
  3.9536287847707453`*^9, 3.953628815769815*^9}, {3.953633831844777*^9, 
  3.95363385107076*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"57ce0d12-1eb6-4358-bfa4-230c4b0f9298"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", 
    RowBox[{
    "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "d", ",",
      "k1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ua", "[", "d", "]"}], "+", 
     RowBox[{"\[CapitalPhi]1", "[", 
      RowBox[{"w", ",", "q", ",", "d", ",", "k1"}], "]"}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "d", ",", "k1"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["3", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "m", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "+", "v", "+", "vp"}], ",", 
        RowBox[{"q", "+", "k", "+", "kp"}], ",", "s", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["3", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "+", "v", "+", "vp"}], ",", 
        RowBox[{"q", "+", "k", "+", "kp"}], ",", "t", ",", "k1"}], "]"}]}]}], 
    "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", 
    RowBox[{
    "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "m", ",",
      "k1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ua", "[", "m", "]"}], "+", 
     RowBox[{"\[CapitalPhi]1", "[", 
      RowBox[{"w", ",", "q", ",", "m", ",", "k1"}], "]"}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "d", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "m", ",", "k1"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "+", "v", "+", "vp"}], ",", 
        RowBox[{"q", "+", "k", "+", "kp"}], ",", "s", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "+", "v", "+", "vp"}], ",", 
        RowBox[{"q", "+", "k", "+", "kp"}], ",", "t", ",", "k1"}], "]"}]}]}], 
    "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", 
    RowBox[{
    "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "s", ",",
      "k1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ua", "[", "s", "]"}], "+", 
     RowBox[{"\[CapitalPhi]1", "[", 
      RowBox[{"w", ",", "q", ",", "s", ",", "k1"}], "]"}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "-", "vp", "-", "v"}], ",", 
        RowBox[{"q", "-", "kp", "-", "k"}], ",", "d", ",", "k1"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["3", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "-", "vp", "-", "v"}], ",", 
        RowBox[{"q", "-", "kp", "-", "k"}], ",", "m", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "d", ",", "k1"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["3", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "m", ",", "k1"}], "]"}]}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", 
    RowBox[{
    "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "t", ",",
      "k1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Ua", "[", "t", "]"}], "+", 
     RowBox[{"\[CapitalPhi]1", "[", 
      RowBox[{"w", ",", "q", ",", "t", ",", "k1"}], "]"}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "-", "vp", "-", "v"}], ",", 
        RowBox[{"q", "-", "kp", "-", "k"}], ",", "d", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"w", "-", "vp", "-", "v"}], ",", 
        RowBox[{"q", "-", "kp", "-", "k"}], ",", "m", ",", "k1"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "d", ",", "k1"}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"\[CapitalPhi]1", "[", 
       RowBox[{
        RowBox[{"vp", "-", "v"}], ",", 
        RowBox[{"kp", "-", "k"}], ",", "m", ",", "k1"}], "]"}]}]}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.95308769911024*^9, 3.953087882546548*^9}, {
  3.9530879206907578`*^9, 3.953088181608781*^9}, {3.95308846042312*^9, 
  3.9530884972098207`*^9}, {3.9530888708629627`*^9, 3.953088925398291*^9}, {
  3.9532785314553823`*^9, 3.953278534674934*^9}, {3.953353527016871*^9, 
  3.953353536647542*^9}, {3.953628829234585*^9, 3.953628836258848*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"b56e633b-9dd7-4b2d-8dff-b7ee2e82b162"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]2", "[", 
   RowBox[{
   "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "a_", ",",
     "k1_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"F2", "[", 
     RowBox[{
     "v", ",", "vp", ",", "w", ",", "k", ",", "kp", ",", "q", ",", "a", ",", 
      "k1"}], "]"}], "-", 
    RowBox[{"\[CapitalPhi]1", "[", 
     RowBox[{"w", ",", "q", ",", "a", ",", "k1"}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.953088285064724*^9, 3.953088344326585*^9}, {
  3.953088508371369*^9, 3.953088511688233*^9}, {3.9530889771697206`*^9, 
  3.953088982705441*^9}, {3.953093279508422*^9, 3.953093289044793*^9}, {
  3.953629234619076*^9, 3.9536292387311773`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"ae8cf3b9-4bde-46a4-8c19-b83a8511ca59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalPhi]2", "[", 
   RowBox[{
   "v_", ",", "vp_", ",", "w_", ",", "k_", ",", "kp_", ",", "q_", ",", "a_"}],
    "]"}], ":=", 
  RowBox[{"cnorm", " ", 
   RowBox[{"MatsubaraSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalGamma]2", "[", 
       RowBox[{
       "v", ",", "v1", ",", "w", ",", "k", ",", "k1", ",", "q", ",", "a", ",",
         "k2"}], "]"}], 
      RowBox[{"\[Chi]0", "[", 
       RowBox[{"v1", ",", "w", ",", "k1", ",", "q", ",", "a"}], "]"}], 
      RowBox[{"F2", "[", 
       RowBox[{
       "v1", ",", "vp", ",", "w", ",", "k1", ",", "kp", ",", "q", ",", "a", ",",
         "k3"}], "]"}]}], ",", 
     RowBox[{"v1", "\[Element]", "Fermionic"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"v", "\[Element]", "Fermionic"}], "&&", 
       RowBox[{"vp", "\[Element]", "Fermionic"}], "&&", 
       RowBox[{"w", "\[Element]", "Bosonic"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.953089014823202*^9, 3.953089128157387*^9}, {
   3.953089199845714*^9, 3.953089200007367*^9}, {3.953093776663724*^9, 
   3.953093783997107*^9}, {3.953093850672756*^9, 3.953093859491432*^9}, {
   3.953093946709701*^9, 3.9530939634777193`*^9}, {3.953269659361137*^9, 
   3.953269659881104*^9}, {3.9532787261721087`*^9, 3.95327872737158*^9}, 
   3.953625189261121*^9, {3.953628868947994*^9, 3.953628872049152*^9}, {
   3.9536289491084003`*^9, 3.953628953034211*^9}, {3.9536292425199013`*^9, 
   3.9536292445568657`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"9b4b3eb2-2768-4abc-8e67-374606ecec45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rmbose", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "B"], "[", "x_", "]"}], "->", 
    RowBox[{
     RowBox[{
      SubscriptBox["n", "F"], "[", "x", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["n", "F"], "[", "x", "]"}]}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toascii", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["n", "F"], "[", "x_", "]"}], "->", 
      RowBox[{"fermidist", "[", 
       RowBox[{"x", ",", "beta"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["n", "F", "\[Prime]"], "[", "x_", "]"}], "->", 
      RowBox[{"dfermidist", "[", 
       RowBox[{"x", ",", "beta"}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmpiecewise", "=", 
   RowBox[{
    RowBox[{"Piecewise", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"valtrue_", ",", "cond_"}], "}"}], "}"}], ",", "valfalse_"}], 
     "]"}], "->", 
    RowBox[{"IfElse", "[", 
     RowBox[{"cond", ",", "valtrue", ",", "valfalse"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodim", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"disp", "[", "_", "]"}], "->", "0"}], ",", 
     RowBox[{"k", "->", "0"}], ",", 
     RowBox[{"kp", "->", "0"}], ",", 
     RowBox[{"q", "->", "0"}], ",", 
     RowBox[{"k1", "->", "0"}], ",", 
     RowBox[{"k2", "->", "0"}], ",", 
     RowBox[{"k3", "->", "0"}], ",", 
     RowBox[{
      RowBox[{"IsZero", "[", "0", "]"}], "->", "True"}], ",", 
     RowBox[{"cnorm", "->", "1"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.953178287930367*^9, 3.953178306019208*^9}, {
   3.953178386864526*^9, 3.9531783927118893`*^9}, {3.953181416063056*^9, 
   3.953181419954514*^9}, 3.953278537649328*^9, {3.95362944731528*^9, 
   3.953629450240254*^9}, {3.953629496581923*^9, 3.953629505441435*^9}, {
   3.953629571987977*^9, 3.953629608018721*^9}, {3.953629651107831*^9, 
   3.953629655391551*^9}, {3.953629694744301*^9, 3.9536297269761333`*^9}, 
   3.953629774841545*^9, {3.953632860469391*^9, 3.9536329291755743`*^9}, 
   3.9536329771992807`*^9, {3.953635585161978*^9, 3.953635589497499*^9}, {
   3.953635761561558*^9, 3.9536357657339363`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"a6a3a1f8-5a9a-4da9-81bb-5040df35a10e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputdirectory", "=", "\"\<wolfram_expressions\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.953279139071108*^9, 3.9532791558083076`*^9}, 
   3.953636114638191*^9},
 CellLabel->
  "In[196]:=",ExpressionUUID->"9ef294c2-ae70-4e76-82ef-0a33fe8a3fb0"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"F2a", "=", 
     RowBox[{
      RowBox[{"F2", "[", 
       RowBox[{
       "v", ",", "vp", ",", "w", ",", "k", ",", "kp", ",", "q", ",", "a", ",",
         "k1"}], "]"}], "/.", "rmpiecewise"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"outputdirectory", ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<full2_``.wl\>\"", ",", "a"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"F2a", "/.", "toascii"}], ",", "\"\<Text\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[CapitalGamma]2a", "=", 
     RowBox[{
      RowBox[{"\[CapitalGamma]2", "[", 
       RowBox[{
       "v", ",", "vp", ",", "w", ",", "k", ",", "kp", ",", "q", ",", "a", ",",
         "k1"}], "]"}], "/.", "rmpiecewise"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"outputdirectory", ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<gamma2_``.wl\>\"", ",", "a"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"\[CapitalGamma]2a", "/.", "toascii"}], ",", "\"\<Text\>\""}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[CapitalPhi]2a", "=", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalPhi]2", "[", 
          RowBox[{
          "v", ",", "vp", ",", "w", ",", "k", ",", "kp", ",", "q", ",", "a"}],
           "]"}], "/.", "rmbose"}], ",", 
        RowBox[{"TimeConstraint", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5"}], "}"}]}]}], "]"}], "/.", "rmpiecewise"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"outputdirectory", ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<phi2_``.wl\>\"", ",", "a"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"\[CapitalPhi]2a", "/.", "toascii"}], ",", "\"\<Text\>\""}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"outputdirectory", ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<full2_0D_``.wl\>\"", ",", "a"}], "]"}]}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"F2a", "//.", "zerodim"}], "]"}], "/.", "toascii"}], 
      ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"outputdirectory", ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<gamma2_0D_``.wl\>\"", ",", "a"}], "]"}]}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"\[CapitalGamma]2a", "//.", "zerodim"}], "]"}], "/.", 
       "toascii"}], ",", "\"\<Text\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"outputdirectory", ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<phi2_0D_``.wl\>\"", ",", "a"}], "]"}]}]}], "]"}], ",", 
      
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"\[CapitalPhi]2a", "//.", "zerodim"}], "]"}], "/.", 
       "toascii"}], ",", "\"\<Text\>\""}], "]"}], ";"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "m", ",", "s", ",", "t"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9531783951528263`*^9, 3.953178397114772*^9}, {
   3.9531786064491777`*^9, 3.9531786113792973`*^9}, {3.95319043057292*^9, 
   3.953190440297349*^9}, {3.953199252102563*^9, 3.95319929217241*^9}, {
   3.95319937123706*^9, 3.953199371795454*^9}, {3.9532009257570877`*^9, 
   3.9532009345369787`*^9}, {3.953200967404931*^9, 3.953200999711656*^9}, 
   3.953201178434887*^9, {3.95325986759549*^9, 3.953259867727585*^9}, {
   3.9532784168221493`*^9, 3.953278424182323*^9}, {3.953278462354136*^9, 
   3.953278466053361*^9}, 3.953278505057111*^9, {3.953278583479761*^9, 
   3.953278583579265*^9}, {3.953278656503015*^9, 3.953278658647276*^9}, {
   3.9532787903169193`*^9, 3.953278840668683*^9}, {3.953278873724297*^9, 
   3.9532788970651217`*^9}, {3.953278982547441*^9, 3.953279135897544*^9}, {
   3.953279185383301*^9, 3.953279225706993*^9}, {3.953279405777516*^9, 
   3.95327941205424*^9}, {3.95328022710777*^9, 3.953280233423147*^9}, {
   3.9536005077021914`*^9, 3.9536005930192842`*^9}, {3.953600640568842*^9, 
   3.9536006497340813`*^9}, {3.953617834074644*^9, 3.953617840383505*^9}, {
   3.9536292524292717`*^9, 3.9536292553112383`*^9}, {3.953629514823739*^9, 
   3.953629517306492*^9}, {3.953630997261284*^9, 3.95363101596446*^9}, {
   3.953631121934417*^9, 3.953631124406466*^9}, {3.95363303401243*^9, 
   3.953633045208679*^9}, {3.953635621574564*^9, 3.953635632161743*^9}, {
   3.953637480362278*^9, 
   3.953637494098222*^9}},ExpressionUUID->"227643d3-61db-4083-b5af-\
5866760c9a66"]
},
WindowSize->{1564, 911},
WindowMargins->{{Automatic, 73}, {Automatic, 67}},
FrontEndVersion->"14.2 for Mac OS X x86 (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"929e1a89-21d7-4a64-92c2-d29b25ec8f3d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 722, 18, 90, "Input",ExpressionUUID->"4f0a758a-204e-49a8-aef7-01220fa0e91a"],
Cell[1279, 40, 608, 15, 49, "Input",ExpressionUUID->"923f2336-213f-4574-bab6-6900ec1a9fd6"],
Cell[1890, 57, 482, 10, 45, "Input",ExpressionUUID->"61b803e5-9398-4b21-9e6b-8645f8f41232"],
Cell[2375, 69, 1581, 46, 122, "Input",ExpressionUUID->"8e544cdf-6057-49f2-bc40-93b45aa5f2f5"],
Cell[3959, 117, 637, 15, 29, "Input",ExpressionUUID->"30b5dbc7-36f1-40a2-8821-0065563f1914"],
Cell[4599, 134, 4616, 113, 172, "Input",ExpressionUUID->"57ce0d12-1eb6-4358-bfa4-230c4b0f9298"],
Cell[9218, 249, 5540, 151, 154, "Input",ExpressionUUID->"b56e633b-9dd7-4b2d-8dff-b7ee2e82b162"],
Cell[14761, 402, 831, 20, 29, "Input",ExpressionUUID->"ae8cf3b9-4bde-46a4-8c19-b83a8511ca59"],
Cell[15595, 424, 1582, 35, 49, "Input",ExpressionUUID->"9b4b3eb2-2768-4abc-8e67-374606ecec45"],
Cell[17180, 461, 2436, 64, 90, "Input",ExpressionUUID->"a6a3a1f8-5a9a-4da9-81bb-5040df35a10e"],
Cell[19619, 527, 287, 7, 29, "Input",ExpressionUUID->"9ef294c2-ae70-4e76-82ef-0a33fe8a3fb0"],
Cell[19909, 536, 5257, 118, 233, "Input",ExpressionUUID->"227643d3-61db-4083-b5af-5866760c9a66"]
}
]
*)

